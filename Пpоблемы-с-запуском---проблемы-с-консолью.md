# FOR ERISTA: При перезагрузке консоли у меня перестал включаться свитч, и не видит tegraRCMgui, порт рабочий. Как быть? 

Возможно вы неправильно установили [cfw](https://docs.google.com/document/u/0/d/16hTgzan8DNfzfttIZNMi-4GiUPw_Gn07KxrC8nVbT_g/edit), или выключили консоль. Либо консоль успела разрядиться. 

И теперь консоль без пейлоада висит в rcm mode с поврежденными файлами запуска. В случае разрядки подержите консоль на зарядке минут 30 и после выполняйте эти действия


1. Подключите свитч к компу, и запустите tegraRCMgui

2. Выключить консоль путем зажатия кнопки выключения на 20-30 секунд 

3. После tegrarcm увидит свитч, пробросьте в него пейлоад [хикейта](https://docs.google.com/document/u/0/d/16hTgzan8DNfzfttIZNMi-4GiUPw_Gn07KxrC8nVbT_g/edit). 

 **Советы в случае использования Auto RCM:**

1. Не разряжайте консоль меньше чем 3-5 %

2. Устанавливайте П.О только с вынимая сд карту находясь в хикейте.



# Как использовать haku33 (Mariko)? Автор @Dolphinnik

**`Предупреждение: Хоумбрю haku33 нужно для полного сброса SysNand'а консоли (в случае если вы использовали пиратки без Emunand'a). Я настоятельно не рекомендую вам использовать его просто так`**

**Подготовка**

1. Подготовленная micro sd карта по всем канонам (Fat32, 64kb), последняя версия сборки которую вы используете, актуальная - [Гайд по созданию флешки](https://github.com/k1gs/NSX-Wiki-/wiki/Вопросы-которые-могут-возникать-у-новичков-при-использовании-CFW,-и-пр.#только-прошил-консоль-что-делать-куда-нажимать-что-устанавливать)

**Действия**

1. Сделайте полный бэкап (В первую очередь Ключи). [Гайд по созданию бекапов](https://github.com/k1gs/NSX-Wiki-/wiki/Пpo-обновления-и-работу-с-кастомной-прошивкой-NSX#какие-бекапы-надо-сделать-и-как)

2. Скачиваем и устанавливаем [haku33](https://github.com/StarDustCFW/Haku33/releases) **Установка: закинуть содержимое архива по пути sdmc:/switch/**

3. Заходим в semi-stock и в нём заходим в hbmenu (Запустить игру/альбом с зажатой кнопкой R)

4. Запустите Haku33 

5. Нажмите кнопку A чтобы начать **форматирование**.

6. После фарматирования вставьте карту с вашей сборкой.

# Восстановления сиснанда с помощью донора

**`Пользуйтесь этим гайдом в случае, если вами был утерян, или поврежден бекап SysNand`**

[Оригинальное руководство, и программы требуемые для восстановления](https://youtu.be/mH8osmtPFlA)

1. Вам необходимо найти донора некоторых файлов для восстановления, такие как **rawnand, prodinfo, prodkeys**. Найти их можно в интеренете, или поспрашивать на тематических источниках: 4pda, Telegramm. Ищите донорский бекап который соответсвует вашей консоли. Т.е, у вас лайт - ищите донора rawnand с лайтом

2. Установите сборку из архива **Unbricking_Packv3** из папки **To console's SD card**. Всё необходимое можно скачать [здесь](https://drive.google.com/file/d/10XVdCW67ITFp_H3badILJyH6amNyvdxO/view?usp=drive_fs). После этого, переместите на вашу сд карту в папку **Switch**, файл с донорским prodinfo.

3. Сделайте дамп prod.keys используя Lockpick_rcm.bin в hekate. Если у вас возникнут ошибки, ничего страшного, дамп будет сделан.

4. После заходим в payloads и выбираем **prodinfo_gen.bin**. Выбираем **Build PRODINFO file from donor. Чтобы выйти нажмите на любую кнопку

5. Достаём SD карту и вставляем её в компьютер. Открываем папку **NxNandManager** и открываем папку **Switch** на сд карте. В папке на карте будет сгенерированный файл prodinfo.bin, переименовываем его в prodinfo.dec(если у вас не виды расширения файлов то в проводнике нажмите на "Вид" -> Расширения имён файлов)

![](https://i.imgur.com/AEcZs2a.png)

6. Перемещаем переименованный файл prodinfo и prodkeys из папки **Switch** в папку **NxNandManager**. Также в эту папку перемещаем наши донорские prodkeys и rawnand

![](https://i.imgur.com/i1CpHVQ.png)

7. Открываем файл extract.bat и ждём окончания. После открываем файл encrypt.bat.После открываем файл flash.bat и нажимаем y.

8. Для того чтобы убедится в работоспособности открываем NxNandManger -> options -> configure keyset -> import keys from file, и выбираете файл prod.keys из папки с программой. После file -> open file -> и выбираем донорский rawnand. Если у вас всё хорошо, то программа отобразит информацию о разделах

![](https://i.imgur.com/L4LlIdV.png)

9. [Скачайте прошивку](https://darthsternie.net/switch-firmwares/)

10. Открываем папку из архива **EmmcHacGen** и распакуйте в папку **fw** прошивку скачанную в 9 пункте. Открываем EmmcHacGenGui

11. В пункте **Select your console** укажите модель вашей консоли(для справки unpatched erista - это 1 ревизия без установленного чипа). В пункте **Select your prod.keys file** выбирайте файл prod.keys из папки **Switch** на SD карте. В пункте **Select firmware folder** укажите путь к папке в которую вы устанвливали прошивку из 10-го пункта. В последнем пункте укажите файл EmmcHacGen.exe из этой же папки. 

12. Нажмите **GO**. Если ничего не произошло, то установите [dot NetCore 3.1](https://dotnet.microsoft.com/en-us/download)

13. В папке с программой вы увидите новую папку, это и есть ваш сгенерированный бекап sysnand. Открываем его, и перемещаем в папку **Switch/Scirpts** папку **SYSTEM** и файл **boot.bis** 

14. Откройте папку **backup/Название_папки_бекапа/restore** на SD карте. Перемещаем в неё донорский rawnand.bin файл из папки **NxNandManager**. Назовите перемещенный файл rawnnand.bin

15. Вставляйте SD карту в консоль. Заходите в hekate -> tools -> Restore eMMC -> Restore RAW GPP.

![](https://i.imgur.com/8jxPz7o.png)

16. Возвращайтесь на домашний экран и выбирите пункт **payloads -> TegraExplorer.bin -> browse SD -> scripts -> SystemRestoreV3.te -> Launch script -> resotre Both -> Для подтверждения нажмите кнопку включения**

17. Возрвращайтесь на домашний экран TegraExplorer и выбирите скрипт **SystemWipe.te -> wipe sysmmc** 

18. Возрвращайтесь на домашний экран TegraExplorer и идите по пути **browse eMMC -> system -> save**. Там вы увидите 3 файла, вам необходимо удалить те которые заканчиваются на d1 и 47. Остаться должен только файл оканчивающийся на 120.

![](https://i.imgur.com/9Q1AEFx.png)

19. Вернитесь на домашний экран TegraExplorer и нажмите на **Reboot Normally**. Если все сделанно верно, то вы увидите экран 1ой настройки консоли.


